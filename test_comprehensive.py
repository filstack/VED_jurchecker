#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤ –≤ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º —Å–∫–ª–æ–Ω–µ–Ω–∏–∏
"""

import sys
sys.stdout.reconfigure(encoding='utf-8')

from jur_checker import JurChecker
import logging

logging.basicConfig(level=logging.ERROR)

print("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è JurChecker...")
jc = JurChecker('registry_entities_rows.csv')

# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏
test_cases = [
    # –ö–ê–¢–ï–ì–û–†–ò–Ø 1: –≠–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—ã (–¥–æ–ª–∂–Ω—ã —Å–∫–ª–æ–Ω—è—Ç—å—Å—è)
    {
        'category': '–≠–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—ã - —Ä–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
        'text': '–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∞–≤–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞ –ø—Ä–æ–≤–µ–ª–∏ –º–∏—Ç–∏–Ω–≥',
        'expected_entity': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
        'expected_alias': '–ø—Ä–∞–≤–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞',
    },
    {
        'category': '–≠–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—ã - –¥–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
        'text': '–ü–æ–º–æ—â—å –ø—Ä–∞–≤–æ–º—É —Å–µ–∫—Ç–æ—Ä—É –±—ã–ª–∞ –æ–∫–∞–∑–∞–Ω–∞',
        'expected_entity': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
        'expected_alias': '–ø—Ä–∞–≤–æ–º—É —Å–µ–∫—Ç–æ—Ä—É',
    },
    {
        'category': '–≠–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—ã - —Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
        'text': '–°–≤—è–∑–∏ —Å –ø—Ä–∞–≤—ã–º —Å–µ–∫—Ç–æ—Ä–æ–º –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã',
        'expected_entity': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
        'expected_alias': '–ø—Ä–∞–≤—ã–º —Å–µ–∫—Ç–æ—Ä–æ–º',
    },
    {
        'category': '–≠–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—ã - –ø—Ä–µ–¥–ª–æ–∂–Ω—ã–π –ø–∞–¥–µ–∂',
        'text': '–°—Ç–∞—Ç—å—è –æ –ø—Ä–∞–≤–æ–º —Å–µ–∫—Ç–æ—Ä–µ –≤—ã—à–ª–∞ –≤ –≥–∞–∑–µ—Ç–µ',
        'expected_entity': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
        'expected_alias': '–ø—Ä–∞–≤–æ–º —Å–µ–∫—Ç–æ—Ä–µ',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 2: –û–¥–Ω–æ—Å–ª–æ–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
    {
        'category': '–û–¥–Ω–æ—Å–ª–æ–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ - –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π',
        'text': '–¢–∞–ª–∏–±–∞–Ω –∑–∞—Ö–≤–∞—Ç–∏–ª –≥–æ—Ä–æ–¥',
        'expected_entity': '–¢–∞–ª–∏–±–∞–Ω',
        'expected_alias': '—Ç–∞–ª–∏–±–∞–Ω',
    },
    {
        'category': '–û–¥–Ω–æ—Å–ª–æ–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ - —Ä–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π',
        'text': '–ë–æ–µ–≤–∏–∫–∏ —Ç–∞–ª–∏–±–∞–Ω–∞ –∞—Ç–∞–∫–æ–≤–∞–ª–∏ –±–∞–∑—É',
        'expected_entity': '–¢–∞–ª–∏–±–∞–Ω',
        'expected_alias': '—Ç–∞–ª–∏–±–∞–Ω–∞',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 3: –¢—Ä–µ—Ö—Å–ª–æ–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è (–ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ + –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ + —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ)
    {
        'category': '–¢—Ä–µ—Ö—Å–ª–æ–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
        'text': '–£–∫—Ä–∞–∏–Ω—Å–∫–æ–µ –Ω–∞—Ü–∏–æ–Ω–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ–ª–æ –∞–∫—Ü–∏—é',
        'expected_entity': None,  # –ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –Ω–∞–π–¥–µ—Ç—Å—è
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 4: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ
    {
        'category': '–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ',
        'text': '–ü—Ä–∞–≤—ã–µ —Å–µ–∫—Ç–æ—Ä–∞ –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏—Å—å',
        'expected_entity': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
        'expected_alias': '–ø—Ä–∞–≤—ã–µ —Å–µ–∫—Ç–æ—Ä–∞',  # –ò–ª–∏ "–ø—Ä–∞–≤—ã—Ö —Å–µ–∫—Ç–æ—Ä–æ–≤"?
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 5: –°–æ—Å—Ç–∞–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å —Å–æ—é–∑–∞–º–∏
    {
        'category': '–ù–∞–∑–≤–∞–Ω–∏–µ —Å —Å–æ—é–∑–æ–º "–∏"',
        'text': '–ò—Å–ª–∞–º—Å–∫–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ –∏ –ê–ª—å-–ö–∞–∏–¥–∞ –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏—Å—å',
        'expected_entity': '–ò—Å–ª–∞–º—Å–∫–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ',
        'expected_alias': '–∏—Å–ª–∞–º—Å–∫–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 6: –õ–∞—Ç–∏–Ω—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
    {
        'category': '–õ–∞—Ç–∏–Ω—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
        'text': 'Organization Greenpeace –ø—Ä–æ–≤–µ–ª–∞ –∞–∫—Ü–∏—é',
        'expected_entity': 'Greenpeace',
        'expected_alias': 'greenpeace',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 7: –ù–∞–∑–≤–∞–Ω–∏—è —Å –∫–∞–≤—ã—á–∫–∞–º–∏ –∏ —Å–∫–æ–±–∫–∞–º–∏
    {
        'category': '–ù–∞–∑–≤–∞–Ω–∏–µ –≤ –∫–∞–≤—ã—á–∫–∞—Ö',
        'text': '–û–±—â–µ—Å—Ç–≤–æ "–ú–µ–º–æ—Ä–∏–∞–ª" –ø—Ä–æ–≤–µ–ª–æ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é',
        'expected_entity': '–ú–µ–º–æ—Ä–∏–∞–ª',
        'expected_alias': '–º–µ–º–æ—Ä–∏–∞–ª',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 8: –ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã
    {
        'category': '–ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞',
        'text': '–ò–ì–ò–õ –∑–∞—Ö–≤–∞—Ç–∏–ª —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é',
        'expected_entity': '–ò—Å–ª–∞–º—Å–∫–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ',
        'expected_alias': '–∏–≥–∏–ª',
    },
    {
        'category': '–ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å–Ω–æ–º',
        'text': '–ë–æ–µ–≤–∏–∫–∏ –ò–ì–ò–õ–∞ –∞—Ç–∞–∫–æ–≤–∞–ª–∏ –±–∞–∑—É',
        'expected_entity': '–ò—Å–ª–∞–º—Å–∫–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ',
        'expected_alias': '–∏–≥–∏–ª–∞',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 9: –ò–º–µ–Ω–∞ –ª—é–¥–µ–π (—Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è - –ù–ï –¥–æ–ª–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å)
    {
        'category': '–§–∞–º–∏–ª–∏—è –±–µ–∑ –∏–º–µ–Ω–∏ (–Ω–µ –¥–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏)',
        'text': '–ù–∞–≤–∞–ª—å–Ω—ã–π –≤—ã—Å—Ç—É–ø–∏–ª –Ω–∞ –º–∏—Ç–∏–Ω–≥–µ',
        'expected_entity': None,
        'expected_alias': None,
    },
    {
        'category': '–§–∞–º–∏–ª–∏—è –≤ —Ä–æ–¥–∏—Ç–µ–ª—å–Ω–æ–º –±–µ–∑ –∏–º–µ–Ω–∏ (–Ω–µ –¥–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏)',
        'text': '–°—Ç–æ—Ä–æ–Ω–Ω–∏–∫–∏ –ù–∞–≤–∞–ª—å–Ω–æ–≥–æ –≤—ã—à–ª–∏ –Ω–∞ —É–ª–∏—Ü—ã',
        'expected_entity': None,
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 10: –ò–º–µ–Ω–∞ –ª—é–¥–µ–π (—Å –∏–Ω–∏—Ü–∏–∞–ª–∞–º–∏ - –î–û–õ–ñ–ù–û –Ω–∞—Ö–æ–¥–∏—Ç—å)
    {
        'category': '–ò–º—è —Å –∏–Ω–∏—Ü–∏–∞–ª–æ–º',
        'text': '–ê. –ù–∞–≤–∞–ª—å–Ω—ã–π –≤—ã—Å—Ç—É–ø–∏–ª –Ω–∞ –º–∏—Ç–∏–Ω–≥–µ',
        'expected_entity': '–ù–∞–≤–∞–ª—å–Ω—ã–π',
        'expected_alias': '–∞. –Ω–∞–≤–∞–ª—å–Ω—ã–π',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 11: –ß–∞—Å—Ç–∏—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (—á–∞—Å—Ç–∏ —Å–ª–æ–≤ - –ù–ï –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å)
    {
        'category': '–ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ —Å–ª–æ–≤–∞',
        'text': '–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∞–≤–æ—Å–µ–∫—Ç–æ—Ä–æ–≤—Ü—ã –ø—Ä–æ–≤–µ–ª–∏ –∞–∫—Ü–∏—é',
        'expected_entity': None,  # "—Å–µ–∫—Ç–æ—Ä" –≤–Ω—É—Ç—Ä–∏ "–ø—Ä–∞–≤–æ—Å–µ–∫—Ç–æ—Ä–æ–≤—Ü—ã" - –Ω–µ –¥–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 12: –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ —á–∞—Å—Ç–æ—Ç–Ω—ã–µ —Å–ª–æ–≤–∞
    {
        'category': '–ß–∞—Å—Ç–æ—Ç–Ω–æ–µ —Å–ª–æ–≤–æ (–Ω–µ –¥–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏)',
        'text': '–†–æ—Å—Å–∏—è –ø—Ä–æ–≤–µ–ª–∞ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã —Å –ö–∏—Ç–∞–µ–º',
        'expected_entity': None,  # "—Ä–æ—Å—Å–∏—è" - —á–∞—Å—Ç–æ—Ç–Ω–æ–µ —Å–ª–æ–≤–æ
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 13: –ù–µ—Å–∫–æ–ª—å–∫–æ —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ –æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ
    {
        'category': '–î–≤–µ —Å—É—â–Ω–æ—Å—Ç–∏ –≤ —Ç–µ–∫—Å—Ç–µ',
        'text': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä –∏ –¢–∞–ª–∏–±–∞–Ω –æ—Å—É–∂–¥–µ–Ω—ã –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º',
        'expected_entity': None,  # –ü—Ä–æ–≤–µ—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ –Ω–∞–π–¥–µ—Ç—Å—è
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 14: –û–ø–µ—á–∞—Ç–∫–∏ –∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è
    {
        'category': '–û–ø–µ—á–∞—Ç–∫–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏',
        'text': '–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∞–≤–æ–≤–∞ —Å–µ–∫—Ç–æ—Ä–∞ –ø—Ä–æ–≤–µ–ª–∏ –º–∏—Ç–∏–Ω–≥',  # "–ø—Ä–∞–≤–æ–≤–∞" –≤–º–µ—Å—Ç–æ "–ø—Ä–∞–≤–æ–≥–æ"
        'expected_entity': None,  # –ù–µ –¥–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 15: –î–ª–∏–Ω–Ω—ã–µ —Å–ª–æ–∂–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
    {
        'category': '–û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
        'text': '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ –∏—Å—Ç–æ—Ä–∏–∫–æ-–ø—Ä–æ—Å–≤–µ—Ç–∏—Ç–µ–ª—å—Å–∫–æ–µ –æ–±—â–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ–ª–æ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é',
        'expected_entity': None,
        'expected_alias': None,
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 16: –°–º–µ—à–∞–Ω–Ω–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞/–ª–∞—Ç–∏–Ω–∏—Ü–∞
    {
        'category': '–°–º–µ—à–∞–Ω–Ω–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞/–ª–∞—Ç–∏–Ω–∏—Ü–∞',
        'text': 'Organization ISIS –ø—Ä–æ–≤–µ–ª–∞ –∞—Ç–∞–∫—É',
        'expected_entity': '–ò—Å–ª–∞–º—Å–∫–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ',
        'expected_alias': 'isis',
    },

    # –ö–ê–¢–ï–ì–û–†–ò–Ø 17: –í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂
    {
        'category': '–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂',
        'text': '–°—É–¥ –ø—Ä–∏–∑–Ω–∞–ª –ø—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π',
        'expected_entity': '–ü—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
        'expected_alias': '–ø—Ä–∞–≤—ã–π —Å–µ–∫—Ç–æ—Ä',
    },
]

print(f"\n–ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ ({len(test_cases)} –∫–µ–π—Å–æ–≤):\n")
print("="*100)

results = {
    'passed': 0,
    'failed': 0,
    'unexpected': 0,
    'details': []
}

for i, case in enumerate(test_cases, 1):
    category = case['category']
    text = case['text']
    expected_entity = case['expected_entity']
    expected_alias = case['expected_alias']

    # –ü–æ–∏—Å–∫
    findings = jc.find_raw_candidates(text)

    # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    if expected_entity is None:
        # –û–∂–∏–¥–∞–µ–º, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ—Ç—Å—è
        if len(findings) == 0:
            status = '‚úÖ PASS'
            results['passed'] += 1
            detail = f"–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–µ –Ω–∞—à–ª–æ (–∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å)"
        else:
            status = '‚ö†Ô∏è  UNEXPECTED'
            results['unexpected'] += 1
            found_entities = [f"{r['entity_name']} (–∫–∞–∫ '{r['found_alias']}')" for r in findings]
            detail = f"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ –Ω–∞—à–ª–æ: {', '.join(found_entities)}"
    else:
        # –û–∂–∏–¥–∞–µ–º –Ω–∞–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å
        if len(findings) == 0:
            status = '‚ùå FAIL'
            results['failed'] += 1
            detail = f"–ù–µ –Ω–∞—à–ª–æ '{expected_entity}'"
        else:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–∞—à–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å
            found_entity = findings[0]['entity_name']
            found_alias = findings[0]['found_alias']

            if expected_alias and expected_alias in found_alias:
                status = '‚úÖ PASS'
                results['passed'] += 1
                detail = f"–ù–∞—à–ª–æ '{found_entity}' –∫–∞–∫ '{found_alias}'"
            elif expected_entity.lower() in found_entity.lower():
                status = '‚úÖ PASS (—á–∞—Å—Ç–∏—á–Ω–æ)'
                results['passed'] += 1
                detail = f"–ù–∞—à–ª–æ '{found_entity}' –∫–∞–∫ '{found_alias}' (–æ–∂–∏–¥–∞–ª–æ—Å—å '{expected_alias}')"
            else:
                status = '‚ùå FAIL'
                results['failed'] += 1
                detail = f"–ù–∞—à–ª–æ '{found_entity}' –∫–∞–∫ '{found_alias}' (–æ–∂–∏–¥–∞–ª–æ—Å—å '{expected_entity}')"

    print(f"{status} [{i}/{len(test_cases)}] {category}")
    print(f"   –¢–µ–∫—Å—Ç: {text}")
    print(f"   {detail}")

    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–æ–∫
    if len(findings) > 1:
        print(f"   –í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ: {len(findings)} —Å—É—â–Ω–æ—Å—Ç–µ–π")

    print()

    results['details'].append({
        'category': category,
        'status': status,
        'text': text,
        'detail': detail,
        'findings_count': len(findings)
    })

# –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
print("="*100)
print("\nüìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n")
print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ:     {results['passed']}/{len(test_cases)} ({results['passed']/len(test_cases)*100:.1f}%)")
print(f"‚ùå –ü—Ä–æ–≤–∞–ª–µ–Ω–æ:   {results['failed']}/{len(test_cases)} ({results['failed']/len(test_cases)*100:.1f}%)")
print(f"‚ö†Ô∏è  –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ:  {results['unexpected']}/{len(test_cases)} ({results['unexpected']/len(test_cases)*100:.1f}%)")

# –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
print("\nüìà –ê–ù–ê–õ–ò–ó –ü–û –ü–†–û–ë–õ–ï–ú–ù–´–ú –û–ë–õ–ê–°–¢–Ø–ú:\n")

failed_categories = [d for d in results['details'] if '‚ùå' in d['status']]
if failed_categories:
    print("–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:")
    for detail in failed_categories:
        print(f"  - {detail['category']}: {detail['detail']}")
else:
    print("–ü—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!")

unexpected_categories = [d for d in results['details'] if '‚ö†Ô∏è' in d['status']]
if unexpected_categories:
    print("\n–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:")
    for detail in unexpected_categories:
        print(f"  - {detail['category']}: {detail['detail']}")

print("\n" + "="*100)
